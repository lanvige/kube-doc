# Kubernetes å…¥é—¨æ–‡ç« é›†

![](assets/kube-logo.png)



è¿™æ˜¯ä¸ªäººå­¦ä¹  Kubernets çš„ä¸€ç³»åˆ—æ€»ç»“æ–‡ç« ã€‚


<br />

## ä» Docker è°ˆèµ·

ä» 15 å¹´å¼€å§‹ï¼Œ å®¹å™¨å°±å¼€å§‹æˆä¸ºæœ€ç«çš„åè¯ï¼ŒDocker å°±æ˜¯å®¹å™¨çš„ä»£åè¯ã€‚

è¿™ä¹Ÿæ¿€å‘äº†åº”ç”¨æ¶æ„çš„ä¸€æ¬¡å˜é©ï¼Œä»å•ä½“æ¶æ„ï¼Œå‘å¾®æœåŠ¡æ¶æ„è½¬ç§»ã€‚

è€Œåˆ°äº† 2017 å¹´ï¼Œæœ€æƒ¨ç§‘æŠ€å…¬å¸æ’è¡Œæœ€é å‰çš„ç«Ÿç„¶æ˜¯è¿™å®¶å…¬å¸ï¼Œè¿™æ°å¥½ä¹Ÿè¯´æ˜äº†ä¸€ä»¶äº‹ï¼Œå®¹å™¨å·²ç»åˆ°è¾¾äº†é¡¶å³°ï¼Œæœªæ¥çš„æ¶æ„ä¼šåœ¨å…¶å®ƒçš„æ–¹å‘è¿›è¡Œå¤§çš„å‘å±•ã€‚

[è¯¦æƒ…](docker.md)


<br />

## ä¸ºä»€ä¹ˆæ˜¯ Kubernets

è°ˆèµ· Kubernetsï¼Œè¿˜æ˜¯è¦å†å›çœ‹å¤´ä¸‹ Dockerï¼Œå®ƒä½œä¸ºå®¹å™¨ï¼Œåªè§£å†³äº†åº”ç”¨è¿è¡Œæ—¶çš„é—®é¢˜ï¼Œä½†åº”ç”¨çš„ç¼–æ’å’Œç½‘ç»œçš„é—®é¢˜ï¼Œä»¥åŠå®¹å™¨çš„å…±äº«å­˜å‚¨ï¼Œéƒ½æ²¡æœ‰å¾ˆå¥½çš„æ–¹æ¡ˆã€‚

è€Œè¿™æ°æ°å°±æ˜¯ Kubernetes æ‰€è¦åšçš„ã€‚



<br />

## åŸºç¡€ç»„ä»¶ Components

æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸‹ Kubernetes ç”±å“ªäº›éƒ¨åˆ†æ¥ç»„æˆçš„ã€‚

Kubernetes ä¸­ï¼Œæœºå™¨è¢«åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼ŒMaster / Node(Worker) ã€‚

Master å’Œ Node å„è‡ªæœ‰å„è‡ªçš„ç»„ä»¶æ¥å·¥ä½œã€‚


* https://kubernetes.io/docs/concepts/overview/components


### ğŸ”… Master

Master ä¸æ˜¯ç”±é€‰ä¸¾è€Œäº§ç”Ÿçš„ï¼Œè€Œæ˜¯åˆå§‹è®¾å®šçš„ã€‚

> Master ä¹Ÿèƒ½åŒæ—¶åšä¸ºä¸€ä¸ª Node å‚äºåº”ç”¨çš„è¿è¡Œè°ƒåº¦ï¼Œè¿™é‡Œæš‚ä¸æ¶‰åŠã€‚

Master åªåœ¨è°ƒåº¦æ—¶æœ‰ç”¨ï¼Œå½“ Worker éƒ½æ­£å¸¸å·¥ä½œä¸”æ²¡æœ‰æ–°çš„è°ƒåº¦å·¥ä½œæ—¶ï¼ŒMaster ä¸‹çº¿æ˜¯ä¸å—å½±å“çš„ã€‚

Master é€šå¸¸ç”±ä»¥ä¸‹å››ä¸ªç»„ä»¶æ„æˆï¼š

* etcd
* kube-apiserver
* kube-scheduler
* kube-controller-manager


#### etcd

etcd æ˜¯æ•´ä¸ªç³»ç»Ÿçš„å­˜å‚¨å•å…ƒï¼Œæ‰€æœ‰çš„ä¿¡æ¯éƒ½è¢«å‚¨å­˜åœ¨è¿™é‡Œã€‚å¯ä»¥ç®€å•çš„ç†è§£ä¸ºä¸€ä¸ªé«˜å¯ç”¨çš„ `key:value` æ•°æ®åº“ã€‚

[è¯¦æƒ…](etcd.md)

#### kube-apiserver

æä¾›ä¸€æ•´å¥—çš„å¯¹å¤– RESTful æ¥å£ï¼Œç”¨äºæ“ä½œå’ŒæŸ¥çœ‹äº‹é¡¹ã€‚


#### kube-scheduler

ä»»åŠ¡æ¥æ—¶ï¼Œè¿›è¡Œè°ƒåº¦çš„å·¥å…·ï¼Œåƒåˆ†é…ä»»åŠ¡åˆ°å“ªä¸€å° Node ä¸Šã€‚


#### kube-controller-manager

ControllerManager ä¼šåœ¨ä¸‹é¢å•ç‹¬ä»‹ç»ã€‚



### ğŸ”… Node

Node è¢«è®¾è®¡ä¸ºåªç”¨æ¥è·‘åº”ç”¨å®¹å™¨ï¼Œæ‰€ä»¥ä¸Šé¢å¿…é¡»è¦æœ‰å®¹å™¨çš„ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯ Dockerã€‚é™¤æ­¤ä¹‹å¤–è¿˜ä¼šæœ‰ä¸¤æ ·å¿…å¤‡çš„ä¸œè¥¿ï¼Œé‚£å°±æ˜¯ kubelet å’Œ kube-proxyã€‚


#### kubelet

kubelet ç”¨äºæ¥æ”¶ Master åˆ†é…åˆ°çš„ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œæ‰§è¡Œã€‚åŒæ—¶ä¹Ÿä¼šå°† Worker ä¸Šçš„ä¿¡æ¯åŒæ­¥ç»™ Masterï¼Œç„¶åå­˜å‚¨åˆ° etcd ä¸­ã€‚


#### kube-proxy

kube-proxy æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ç»„ä»¶ï¼Œç”¨äºç½‘ç»œã€‚å®ƒçš„åŠŸèƒ½å°±æ˜¯ä» master ä¸Šæ‹‰ä¸‹æ¥ä¿¡æ¯ï¼Œç„¶åæ›´æ–°æœ¬æœºçš„ iptables è§„åˆ™ï¼Œè®©ç½‘ç»œå¯è¾¾ã€‚

è¿™éƒ¨åˆ†ä¼šåœ¨ç½‘ç»œéƒ¨åˆ†æ›´å¤šæåŠã€‚


### ğŸ”… kubectl

kubectl æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨æ¥æ“ä½œ Kubernetes çš„ï¼Œå®ƒå¯ä»¥åœ¨ä»»ä½•ä¸€å°æœºå™¨ä¸Šæ‰§è¡Œã€‚





<br />



## æ¦‚å¿µ / Concepts

Kubernets è§£å†³äº†å¾ˆå¤šçš„é—®é¢˜ï¼Œä½†ä¹Ÿæå‡ºäº†å¾ˆå¤šçš„æ¦‚å¿µã€‚å®ƒå¯æ¯” Docker è¦å¤æ‚çš„å¤šã€‚


### ğŸ”… Pod

Kubernetes åœ¨å®¹å™¨çš„æ¦‚å¿µä¸Šåˆè¿›è¡Œäº†ä¸€æ¬¡å°è£…ï¼Œå« Podï¼Œå®ƒè®¤ä¸ºå•çš„çš„å®¹å™¨ä¸èƒ½å¾ˆå¥½çš„å®Œæˆä¸€äº›æŒ‡å®šçš„å·¥ä½œã€‚è€Œ Pod åˆ™å¯ä»¥æŠŠå¤šä¸ªå®¹å™¨æ”¾åœ¨ä¸€èµ·è¿›è¡Œè°ƒåº¦ï¼Œåœ¨åŒä¸€ä¸ª Pod é—´çš„å®¹å™¨å¯ä»¥æ›´å¥½çš„é€šè®¯ã€‚

[è¯¦æƒ…](pod.md)

### ğŸ”… Service

Pod æ˜¯åŠ¨æ€çš„ï¼Œå®ƒæ˜¯ Kubernetes æ‰©å®¹ç¼©å®¹çš„è°ƒåº¦å•ä½ï¼Œä¸èƒ½ç›´æ¥å¯¹å¤–æä¾›ï¼Œæ‰€ä»¥åœ¨å¤–å±‚åšäº†ä¸€ä¸ª Proxyï¼Œè¿™ä¸ª Proxy å°±æ˜¯ Serviceï¼ŒService æœ‰å¯¹å¤–æä¾›æœåŠ¡çš„èƒ½åŠ›ã€‚

Service å¯¹å¤–æä¾›æœåŠ¡æœ‰ä¸‰ç§å½¢å¼

- NodePort
- Ingress
- LoadBlance

å…³äº Service å’Œè¿™å‡ è·Ÿä¸Šå½¢å¼çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è§ï¼š[è¯¦æƒ…](service.md)


### ğŸ”… Ingress

è™½ç„¶ Service èƒ½é€šè¿‡ NodePort å¯¹å¤–æä¾›æœåŠ¡ï¼Œä½†éœ€è¦æ‰‹åŠ¨é…ç½®ç«¯å£ï¼ŒæœåŠ¡å¤šèµ·æ¥çš„è¯ï¼Œä¼šæˆä¸ºä¸€ä¸ªæ–°çš„ç“¶é¢ˆï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªæ–°çš„ç»„ä»¶ Ingress æ¥è§£å†³äº†ã€‚

Ingress ç›¸å¯¹äº NodePort æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬å•ç‹¬æ‹¿å‡ºæ¥è®²ä¸€ä¸‹ï¼š

[è¯¦æƒ…](ingress.md)


### ğŸ”… Deployment

å¦‚ä½•å‘å¸ƒä¸€ä¸ª å¯åŠ¨ä¸€ä¸ª Pod å‘¢ï¼Ÿæœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œå¯ä»¥å•ç‹¬çš„å‘å¸ƒ Podï¼Œä¹Ÿå¯ä»¥ç”± ReplicaSet è¿›è¡Œã€‚ä¹Ÿå¯ä»¥ç”¨ Deployment çš„æ–¹å¼ã€‚

è¿™æ˜¯æœ€æ¨èçš„æ–¹å¼ã€‚


[è¯¦æƒ…](deployment.md)


### ğŸ”… å¯¹è±¡

å¯¹è±¡æ˜¯ Kubernetes ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå®ƒæŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½å®šä¹‰ä¸ºå¯¹è±¡ï¼Œå¯¹è±¡æœ‰ä¸¤ç§çŠ¶æ€ï¼Œä¸€ç§æ˜¯å®šä¹‰çš„ï¼Œä¸€ç§æ˜¯å®é™…çš„ã€‚

> è¿™æœ‰ç‚¹åƒ FLUX çš„å•å‘æ•°æ®æµï¼Œæ°¸è¿œåªæ“ä½œæ•°æ®ï¼Œç„¶åé¡µé¢ä¼šæ”¹å˜å’Œæ•°æ®ä¿æŒä¸€è‡´ã€‚

> Controller Manager å°±æ˜¯æŠŠè¿™ä¸¤ç§çŠ¶æ€è¿›è¡Œæ ¡æ­£çš„çš„åå°æœåŠ¡ã€‚

å…³äº Object çš„æ›´å¤šä»‹ç»ï¼Œå‚è§ [è¯¦æƒ…](object.md)


### ğŸ”… Controller Manager

ä¸Šé¢ä»‹ç»äº†è¿™äº›æ¦‚å¿µï¼Œå®ƒä»¬æ˜¯æ€ä¹ˆè¿è½¬çš„å‘¢ï¼Ÿ

å®ƒä»¬æ˜¯ç”± Controller Manager æ¥è¿›è¡Œæ‰§è¡Œçš„ã€‚

å¸¸è§çš„ Controller Manager æœ‰ï¼š

- Node Controller
- Replication Controller
- Endpoints Controller
- Service Account & Token Controllers

[è¯¦æƒ…](controller.md)



<br>

## ç½‘ç»œ / Network

ç½‘ç»œæ˜¯ Kubernetes çš„åŸºçŸ³ï¼Œæ²¡æœ‰ç½‘ç»œï¼Œå°±æ²¡æœ‰ Kubernetes çš„ä¸€åˆ‡ã€‚

### ğŸ”… CNI

[è¯¦æƒ…](cni.md)

### å¸¸ç”¨çš„ç½‘ç»œç»„è§ï¼š

#### - Flannel

[è¯¦æƒ…](flannel.md)

#### - Calico

[è¯¦æƒ…](calico.md)

### ğŸ”… kube-proxy



<br>

## å®‰å…¨


### ğŸ”… Account 

[è¯¦æƒ…](account.md)

### ğŸ”… RBAC

[è¯¦æƒ…](rbac.md)


### ğŸ”… Service Account

[è¯¦æƒ…](service-account.md)




<br>

## å­˜å‚¨





<br>

## Other


### ğŸ”… Dashboard

Kubernetes æä¾›äº†ä¸€ä¸ªå¥½çš„æ–¹å¼æ¥æŸ¥çœ‹å½“å‰çš„çŠ¶æ€ã€‚å°±æ˜¯ kube-dashboard

[è¯¦æƒ…](dashboard.md)


